<div class="flex flex-col lg:flex-row max-w-6xl mx-auto mt-10 mb-20 gap-6 px-4">

    <!-- Menú lateral -->
    <aside class="w-full lg:w-1/4 bg-base-100 rounded-xl shadow-md p-4 h-fit">
        <h3 class="text-lg font-semibold mb-4">Opciones</h3>
        <ul class="menu bg-base-200 rounded-box w-full">
            <li><a [ngClass]="{ 'active': tab === 'perfil' }" (click)="tab = 'perfil'">Perfil</a></li>
            <li><a [ngClass]="{ 'active': tab === 'direccion' }" (click)="tab = 'direccion'">Dirección</a></li>
            <li><a [ngClass]="{ 'active': tab === 'metodos' }" (click)="tab = 'metodos'">Métodos de Pago</a></li>
            <li><a [ngClass]="{ 'active': tab === 'pedidos' }" (click)="tab = 'pedidos'">Pedidos Realizados</a></li>
        </ul>
    </aside>

    <!-- Contenido principal -->
    <section class="flex-1 bg-base-100 p-6 rounded-xl shadow-md space-y-6">

        <!-- PERFIL -->
        <div *ngIf="tab === 'perfil'" class="space-y-8">
            <!-- Avatar -->
            <div class="flex flex-col items-center space-y-2">
                <div class="avatar">
                    <div class="w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2">
                        <img [src]="user.photo" alt="Foto de perfil" />
                    </div>
                </div>
                <h2 class="text-xl font-bold text-center">{{ user.name }} {{ user.lastname }}</h2>
                <p class="text-sm text-gray-500 italic text-center">{{ user.username }} - {{ user.rol?.toUpperCase() }}
                </p>
            </div>

            <!-- Datos personales + contraseña -->
            <div class="grid md:grid-cols-2 gap-6">

                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Nombre de Usuario</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing" [(ngModel)]="user.username" />
                </div>

                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Email</label>
                    <input class="input input-bordered w-full" type="email" [readonly]="!isEditing"
                        [(ngModel)]="user.email" />
                </div>

                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Nombre</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing" [(ngModel)]="user.name" />
                </div>

                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Apellidos</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing" [(ngModel)]="user.lastname" />
                </div>

                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Teléfono</label>
                    <input class="input input-bordered w-full" type="tel" [readonly]="!isEditing"
                        [(ngModel)]="user.phone" />
                </div>

                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Foto (URL)</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing" [(ngModel)]="user.photo" />
                </div>

                <!-- Botón cambiar contraseña -->
                <div *ngIf="isEditing" class="form-control md:col-span-2">
                    <button class="btn btn-outline w-fit" type="button"
                        (click)="showPasswordChange = !showPasswordChange">
                        {{ showPasswordChange ? 'Cancelar cambio de contraseña' : 'Cambiar contraseña' }}
                    </button>
                </div>

                <!-- Inputs de cambio de contraseña -->
                <ng-container *ngIf="showPasswordChange">
                    <div class="form-control md:col-span-2">
                        <label class="label-text font-semibold mb-1">Contraseña actual</label>
                        <input class="input input-bordered w-full" type="password" [(ngModel)]="passwordForm.current"
                            placeholder="Introduce tu contraseña actual" />
                    </div>

                    <div class="form-control w-full">
                        <label class="label-text font-semibold mb-1">Nueva contraseña</label>
                        <input class="input input-bordered w-full" type="password" [(ngModel)]="passwordForm.new"
                            placeholder="Nueva contraseña" />
                    </div>

                    <div class="form-control w-full">
                        <label class="label-text font-semibold mb-1">Repetir nueva contraseña</label>
                        <input class="input input-bordered w-full" type="password" [(ngModel)]="passwordForm.confirm"
                            placeholder="Repetir nueva contraseña" />
                    </div>
                </ng-container>

            </div>

            <!-- Botón guardar/editar -->
            <div class="text-center">
                <button class="btn btn-primary" (click)="isEditing = !isEditing">
                    {{ isEditing ? 'Guardar Cambios' : 'Editar Perfil' }}
                </button>
            </div>
        </div>

        <!-- DIRECCIÓN -->
        <div *ngIf="tab === 'direccion'" class="space-y-8">
            <h4 class="text-lg font-semibold mt-4">Dirección</h4>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Calle</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.street" />
                </div>
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Número</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.number" />
                </div>
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Piso</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.flat" />
                </div>
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Puerta</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.door" />
                </div>
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Ciudad</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.city" />
                </div>
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Provincia</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.state" />
                </div>
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">País</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.country" />
                </div>
                <div class="form-control w-full">
                    <label class="label-text font-semibold mb-1">Código Postal</label>
                    <input class="input input-bordered w-full" [readonly]="!isEditing"
                        [(ngModel)]="user.address.postalCode" />
                </div>
            </div>
            <div class="text-center">
                <button class="btn btn-primary" (click)="isEditing = !isEditing">
                    {{ isEditing ? 'Guardar Dirección' : 'Editar Dirección' }}
                </button>
            </div>
        </div>

        <!-- MÉTODOS DE PAGO -->
        <div *ngIf="tab === 'metodos'" class="space-y-2">
            <h3 class="text-xl font-semibold mb-2">Métodos de Pago</h3>
            <p class="text-gray-500">Aquí se mostrarán los métodos de pago guardados.</p>
        </div>

        <!-- PEDIDOS -->
        <div *ngIf="tab === 'pedidos'" class="space-y-2">
            <h3 class="text-xl font-semibold mb-2">Pedidos Realizados</h3>
            <p class="text-gray-500">Aquí aparecerá el historial de pedidos del usuario.</p>
        </div>

    </section>
</div>